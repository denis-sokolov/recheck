<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">Matching VM Acceleration | recheck</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://makenowjust-labo.github.io/recheck/docs/internals/matching-acceleration"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Matching VM Acceleration | recheck"><meta data-react-helmet="true" name="description" content="Describes how to accelerate regular expression matching."><meta data-react-helmet="true" property="og:description" content="Describes how to accelerate regular expression matching."><link data-react-helmet="true" rel="icon" href="/recheck/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://makenowjust-labo.github.io/recheck/docs/internals/matching-acceleration"><link data-react-helmet="true" rel="alternate" href="https://makenowjust-labo.github.io/recheck/docs/internals/matching-acceleration" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://makenowjust-labo.github.io/recheck/docs/internals/matching-acceleration" hreflang="x-default"><link rel="stylesheet" href="/recheck/assets/css/styles.6492ed34.css">
<link rel="preload" href="/recheck/assets/js/runtime~main.d83751d2.js" as="script">
<link rel="preload" href="/recheck/assets/js/main.e01914e2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_QVmC">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/recheck/"><div class="navbar__logo"><img src="/recheck/img/logo-light.svg" alt="Recheck Logo" class="themedImage_3EHU themedImage--light_heW6"><img src="/recheck/img/logo-dark.svg" alt="Recheck Logo" class="themedImage_3EHU themedImage--dark_6pZL"></div><b class="navbar__title">Recheck</b></a><a class="navbar__item navbar__link navbar__link--active" href="/recheck/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/recheck/playground">Playground</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/MakeNowJust-Labo/recheck" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_OX1T"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_5Cll toggle_pM6S toggleDisabled_suNH"><div class="toggleTrack_6qEH" role="button" tabindex="-1"><div class="toggleTrackCheck_QiMw"><span class="toggleIcon_WliK">ðŸŒœ</span></div><div class="toggleTrackX_9NbQ"><span class="toggleIcon_WliK">ðŸŒž</span></div><div class="toggleTrackThumb_KZ0J"></div></div><input type="checkbox" class="toggleScreenReader_H7wj" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_qWWs"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_THz+" type="button"></button><aside class="docSidebarContainer_uK7U"><div class="sidebar_Fbmv"><nav class="menu thin-scrollbar menu_f6NZ"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/recheck/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_dFKL" href="/recheck/docs/category/usage">Usage</a><button aria-label="Toggle the collapsible sidebar category &#x27;Usage&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/recheck/docs/usage/as-javascript-library">As JavaScript Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/recheck/docs/usage/as-scala-library">As Scala Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/recheck/docs/usage/as-eslint-plugin">As ESLint Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/recheck/docs/usage/parameters">Parameters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/recheck/docs/usage/diagnostics">Diagnostics</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_dFKL" href="/recheck/docs/category/internals">Internals</a><button aria-label="Toggle the collapsible sidebar category &#x27;Internals&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/recheck/docs/internals/background">Background on Automata Theory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/recheck/docs/internals/fuzzing">Fuzzing with Static Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/recheck/docs/internals/matching-acceleration">Matching VM Acceleration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/recheck/docs/internals/criteria">Criteria to Decide Algorithm</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_Pt0n"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_+ye-"><div class="docItemContainer_G97A"><article><div class="tocCollapsible_Rhao theme-doc-toc-mobile tocMobile_HuTu"><button type="button" class="clean-btn tocCollapsibleButton_Rimw">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Matching VM Acceleration</h1></header><p>Describes how to accelerate regular expression matching.</p><h2 class="anchor anchorWithStickyNavbar_XX5z" id="regular-expression-matching">Regular Expression Matching<a class="hash-link" href="#regular-expression-matching" title="Direct link to heading">â€‹</a></h2><p>Regular expression matching is done many times during fuzzing, so it is important to accelerate it. Although many methods to accelerate matching have been studied, it is not easy to use them directly for <code>recheck</code> fuzzing, because we want to determine how long matching takes, so we have to accelerate it and mimic the behavior of existing matching implementations at the same time.</p><p>A typical method to speed up regular expression matching is to construct a deterministic finite state automaton (DFA). In some cases, instead of actually constructing a DFA, we can execute the states of the NFA in parallel and cache the same set of states. However, it is difficult to mimic the priority of backtracking because these methods hide the structure of backtracking, and they cannot interpret backreferences correctly because they rely on finite state automata.</p><p>Therefore, we decided to use selective memoization by Davis et al. in <code>recheck</code>.</p><h2 class="anchor anchorWithStickyNavbar_XX5z" id="acceleration-by-memoization">Acceleration by Memoization<a class="hash-link" href="#acceleration-by-memoization" title="Direct link to heading">â€‹</a></h2><p>The key idea in Davis et al.&#x27;s work is the following</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Theorem (NFA matching memoization)</h5></div><div class="admonition-content"><p>When matching by NFA backtracking, if it memoizes the results from the confluence of branches in the transition diagram, it will reach a certain state at a certain position in the input string at most once.</p></div></div><p class="text--center"></p><div style="background-size:cover;background-repeat:no-repeat;position:relative;background-image:url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAICAYAAADA+m62AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAgUlEQVQYlZVQWw4EIQjz/oeaQ8xNdOIDULopO5M4+7ckjVgKVZK7g2DMOVFrxRgj7n7Xli+kYG6ylAJVDbGIPKWIxClrrRBwEk8zi5w888MPJBK9d7TWXhNsGq58oYyCU8+vkCKK96BTzhkyBNDNmm+iLUFut/7vM/t62E3B73qID1OdOncRbgVJAAAAAElFTkSuQmCC&quot;)"><svg style="width:100%;height:auto;max-width:100%;margin-bottom:-4px" width="1700" height="1288"></svg><noscript><img style="width:100%;height:auto;max-width:100%;margin-bottom:-4px;position:absolute;top:0;left:0" src="/recheck/assets/ideal-img/confluence.723b242.1700.png" srcset="/recheck/assets/ideal-img/confluence.723b242.1700.png 1700w" width="1700" height="1288"></noscript></div><p></p><p>By using this theorem, the time taken for regular expression matching can be made linear to the length of the input string in most cases. Furthermore, since it actually performs backtracking matching, it can mimic the behavior of exact backtracking by recording the number of times a character is read from the confluence until the matching fails, and adding it when it reaches the confluence again.</p><p>However, since the implementation of regular expression matching in <code>recheck</code> is based on VM, it should be applied to the confluence of branch instructions, instead of the confluence of branches in the transition diagram.</p><header><h1>Notes</h1></header><ul><li>The same acceleration against backreferences can be done by memoizing including the captured positions, but this may actually slow down the matching. Thus, <code>recheck</code> does not perform this acceleration by default when backreferences are included.</li><li>At this time, we do not adopt the compression for the memoization data structure in Davis et al.â€™s research.</li></ul><header><h1>References</h1></header><ul><li><a id="davis-2021">[1]</a> Davis, James C., Francisco Servant, and Dongyoon Lee. &quot;Using selective memoization to defeat regular expression denial of service (ReDoS).&quot; <em>2021 IEEE Symposium on Security and Privacy (SP), Los Alamitos, CA, USA</em>. 2021.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/MakeNowJust-Labo/recheck/tree/main/website/docs/docs/internals/matching-acceleration.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_glMr" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_D6LQ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/recheck/docs/internals/fuzzing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Fuzzing with Static Analysis</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/recheck/docs/internals/criteria"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Criteria to Decide Algorithm</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_thVJ thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#regular-expression-matching" class="table-of-contents__link toc-highlight">Regular Expression Matching</a></li><li><a href="#acceleration-by-memoization" class="table-of-contents__link toc-highlight">Acceleration by Memoization</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/recheck/docs/intro">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/recheck/docs/category/usage">Usage</a></li><li class="footer__item"><a class="footer__link-item" href="/recheck/docs/category/internals">Internals</a></li></ul></div><div class="col footer__col"><div class="footer__title">Try</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/recheck/playground">Playground</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/MakeNowJust-Labo/recheck" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub Repository<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_OX1T"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/MakeNowJust-Labo" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>@MakeNowJust-Labo<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_OX1T"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2020-2022 TSUYUSATO "MakeNowJust" Kitsune. Built with Docusaurus.</div></div></div></footer></div>
<script src="/recheck/assets/js/runtime~main.d83751d2.js"></script>
<script src="/recheck/assets/js/main.e01914e2.js"></script>
</body>
</html>