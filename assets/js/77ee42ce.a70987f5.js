"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[563],{5318:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var i=n(7378);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),p=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return i.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=p(n),d=a,h=m["".concat(s,".").concat(d)]||m[d]||u[d]||r;return n?i.createElement(h,o(o({ref:t},c),{},{components:n})):i.createElement(h,o({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var p=2;p<r;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8755:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return c},default:function(){return m}});var i=n(5773),a=n(808),r=(n(7378),n(5318)),o=["components"],l={id:"diagnostics",title:"Diagnostics"},s=void 0,p={unversionedId:"usage/diagnostics",id:"usage/diagnostics",title:"Diagnostics",description:"Diagnostics is a result type of checking. In Scala, it is a sealed class.",source:"@site/docs/usage/diagnostics.md",sourceDirName:"usage",slug:"/usage/diagnostics",permalink:"/recheck/docs/usage/diagnostics",editUrl:"https://github.com/MakeNowJust-Labo/recheck/tree/main/website/docs/docs/usage/diagnostics.md",tags:[],version:"current",frontMatter:{id:"diagnostics",title:"Diagnostics"},sidebar:"docs",previous:{title:"Parameters",permalink:"/recheck/docs/usage/parameters"},next:{title:"Internals",permalink:"/recheck/docs/category/internals"}},c=[{value:"Common Fields",id:"common-fields",children:[],level:2},{value:"Status",id:"status",children:[],level:2},{value:"Complexity",id:"complexity",children:[],level:2},{value:"Attack String",id:"attack-string",children:[],level:2},{value:"Hotspot",id:"hotspot",children:[],level:2}],u={toc:c};function m(e){var t=e.components,n=(0,a.Z)(e,o);return(0,r.kt)("wrapper",(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Diagnostics")," is a result type of checking. In Scala, it is a ",(0,r.kt)("inlineCode",{parentName:"p"},"sealed class"),".\nBut in TypeScript, it is a serialized object.\nHowever, they have the same information. We will describe this."),(0,r.kt)("h2",{id:"common-fields"},"Common Fields"),(0,r.kt)("p",null,"All ",(0,r.kt)("inlineCode",{parentName:"p"},"Diagnostics")," has the following fields."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"source")," is the given regular expression\u2019s source string."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"flags")," is the given regular expression\u2019s flags string."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"checker")," is a checker type to be used (one of ",(0,r.kt)("inlineCode",{parentName:"li"},"fuzz")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"automaton"),").")),(0,r.kt)("h2",{id:"status"},"Status"),(0,r.kt)("p",null,"Known that already, ",(0,r.kt)("inlineCode",{parentName:"p"},"Diagnostics")," has three statuses."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"safe")," means the given regular expression seems safe at least in this checking."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"vulnerable")," means vulnerability in the given regular expression is found."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"unknown")," means something wrong happened in checking (timeout, cancel, or error). It has the ",(0,r.kt)("inlineCode",{parentName:"li"},"error")," field to describe the reason for this result.")),(0,r.kt)("h2",{id:"complexity"},"Complexity"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"safe")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"vulnerable")," has the ",(0,r.kt)("inlineCode",{parentName:"p"},"complexity")," field.\nThis field contains the matching time complexity estimated in this checking.\nThere are five ",(0,r.kt)("inlineCode",{parentName:"p"},"complexity")," varieties."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"safe"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"constant"),", and ",(0,r.kt)("inlineCode",{parentName:"li"},"linear")," are safe matching time complexity."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"polynomial")," is a vulnerable matching time complexity. It has an additional field called ",(0,r.kt)("inlineCode",{parentName:"li"},"degree")," which represents the maximum degree of the matching time complexity polynomial."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"exponential")," is a vulnerable matching time complexity.")),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If the complexity is exponential, you must fix the regular expression as soon as possible.\nIt may invoke a matching time explosion against too little string (",(0,r.kt)("inlineCode",{parentName:"p"},"length < 100"),")."))),(0,r.kt)("h2",{id:"attack-string"},"Attack String"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"vulnerable")," status diagnostics has the ",(0,r.kt)("inlineCode",{parentName:"p"},"attack")," field. It contains the attack string obtained by this checking."),(0,r.kt)("p",null,"The attack string is a string to invoke the matching time explosion as known as ReDoS vulnerability."),(0,r.kt)("p",null,"It is a string with a repetition structure. It consists of ",(0,r.kt)("inlineCode",{parentName:"p"},"pumps"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"suffix"),", and the ",(0,r.kt)("inlineCode",{parentName:"p"},"base")," repetition count.\nEach ",(0,r.kt)("inlineCode",{parentName:"p"},"pump")," consists of ",(0,r.kt)("inlineCode",{parentName:"p"},"prefix"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"repeating")," substrings, and the individual repetition count ",(0,r.kt)("inlineCode",{parentName:"p"},"n"),". The actual string forms ",(0,r.kt)("inlineCode",{parentName:"p"},"prefix + repeating.repeat(base + n) + ... + suffix"),"."),(0,r.kt)("p",null,"Noting that the attack string is computed in theoretical, because of the real matching implementation\u2019s optimization, it may not invoke the matching time explosion.\nTo prevent this case, you should use the recall validation."),(0,r.kt)("h2",{id:"hotspot"},"Hotspot"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"hotspot")," is another interesting field in ",(0,r.kt)("inlineCode",{parentName:"p"},"vulnerable")," status diagnostics."),(0,r.kt)("p",null,"It shows a hotspot in the given regular expression.\nA hotspot is a substring in the given regular expression that is executed many times against the attack string."),(0,r.kt)("p",null,"It helps you to fix the regular expression to a safe one."))}m.isMDXComponent=!0}}]);