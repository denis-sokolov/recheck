"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[363],{8519:function(e,a,n){n.r(a),n.d(a,{frontMatter:function(){return c},contentTitle:function(){return p},metadata:function(){return d},toc:function(){return m},SBTInstallCodeBlock:function(){return u},default:function(){return h}});var t=n(5773),i=n(808),o=(n(7378),n(5318)),r=n(4014),l=n(1798),s=["components"],c={id:"as-scala-library",title:"As Scala Library"},p=void 0,d={unversionedId:"usage/as-scala-library",id:"usage/as-scala-library",title:"As Scala Library",description:"export const SBTInstallCodeBlock = () => {",source:"@site/docs/usage/as-scala-library.mdx",sourceDirName:"usage",slug:"/usage/as-scala-library",permalink:"/recheck/docs/usage/as-scala-library",editUrl:"https://github.com/MakeNowJust-Labo/recheck/tree/main/website/docs/docs/usage/as-scala-library.mdx",tags:[],version:"current",frontMatter:{id:"as-scala-library",title:"As Scala Library"},sidebar:"docs",previous:{title:"As JavaScript Library",permalink:"/recheck/docs/usage/as-javascript-library"},next:{title:"As ESLint Plugin",permalink:"/recheck/docs/usage/as-eslint-plugin"}},m=[{value:"Install",id:"install",children:[],level:2},{value:"Usage",id:"usage",children:[{value:"Cancel",id:"cancel",children:[],level:3}],level:2}],u=function(){var e=(0,r.Z)().siteConfig.customFields.version;return(0,o.kt)(l.Z,{title:"build.sbt",className:"language-scala",mdxType:"CodeBlock"},'libraryDependencies += "codes.quine.labo" %% "recheck-core" % "',e,'"')},k={toc:m,SBTInstallCodeBlock:u};function h(e){var a=e.components,n=(0,i.Z)(e,s);return(0,o.kt)("wrapper",(0,t.Z)({},k,n,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Describes how to use ",(0,o.kt)("inlineCode",{parentName:"p"},"recheck")," as a Scala library."),(0,o.kt)("h2",{id:"install"},"Install"),(0,o.kt)("p",null,"To install the Scala library of ",(0,o.kt)("inlineCode",{parentName:"p"},"recheck"),", you should append the following line into your ",(0,o.kt)("inlineCode",{parentName:"p"},"build.sbt"),"."),(0,o.kt)(u,{mdxType:"SBTInstallCodeBlock"}),(0,o.kt)("h2",{id:"usage"},"Usage"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"ReDoS.check")," is the only entry point for checking the vulnerability of regular expression."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},'import codes.quine.labo.recheck.ReDoS\n\nReDoS.check("^(a|a)*$", "")\n')),(0,o.kt)("p",null,"The first argument of ",(0,o.kt)("inlineCode",{parentName:"p"},"ReDoS.check")," is the ",(0,o.kt)("inlineCode",{parentName:"p"},"source")," which is corresponding to ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/source"},(0,o.kt)("inlineCode",{parentName:"a"},"RegExp.prototype.source")),".\nAnd, the second argument is the ",(0,o.kt)("inlineCode",{parentName:"p"},"flags")," which is corresponding to ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/flags"},(0,o.kt)("inlineCode",{parentName:"a"},"RegExp.prototype.flags"))," too.\nThe third argument is the ",(0,o.kt)("inlineCode",{parentName:"p"},"params")," to specify parameters for the checker behavior, and the fourth is the ",(0,o.kt)("inlineCode",{parentName:"p"},"token")," to cancel the checking in the middle."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"See ",(0,o.kt)("a",{parentName:"p",href:"/recheck/docs/usage/parameters"},"this page")," for detailed information on ",(0,o.kt)("inlineCode",{parentName:"p"},"Parameters")," value."))),(0,o.kt)("p",null,"The result of ",(0,o.kt)("inlineCode",{parentName:"p"},"ReDoS.check")," is called ",(0,o.kt)("inlineCode",{parentName:"p"},"Diagnostics"),".\n",(0,o.kt)("inlineCode",{parentName:"p"},"Diagnostics")," is a ",(0,o.kt)("inlineCode",{parentName:"p"},"sealed class"),", and it has three child classes."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Diagnostics.Safe")," means the given regular expression seems safe at least in this checking."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Diagnostics.Vulnerable")," means vulnerability in the given regular expression is found."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Diagnostics.Unknown")," means something wrong happened in checking (timeout, cancel, or error).")),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"See ",(0,o.kt)("a",{parentName:"p",href:"/recheck/docs/usage/diagnostics"},"this page")," for detailed information on ",(0,o.kt)("inlineCode",{parentName:"p"},"Diagnostics")," value."))),(0,o.kt)("h3",{id:"cancel"},"Cancel"),(0,o.kt)("p",null,"The fourth argument of ",(0,o.kt)("inlineCode",{parentName:"p"},"ReDoS.check")," is used to cancel the checking in the middle.\nThis type is ",(0,o.kt)("inlineCode",{parentName:"p"},"CancellationToken")," which is created by ",(0,o.kt)("inlineCode",{parentName:"p"},"CancellationTokenSource"),".\nNoting that ",(0,o.kt)("inlineCode",{parentName:"p"},"ReDoS.check")," blocks the process, you should use this with concurrent libraries like ",(0,o.kt)("inlineCode",{parentName:"p"},"scala.concurrent"),"or ",(0,o.kt)("inlineCode",{parentName:"p"},"[cats-effect](https://typelevel.org/cats-effect/)"),"."),(0,o.kt)("p",null,"The following example is usage with ",(0,o.kt)("inlineCode",{parentName:"p"},"cats-effect"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},"import codes.quine.labo.recheck.ReDoS\nimport codes.quine.labo.recheck.common.CancellationTokenSource\nimport codes.quine.labo.recheck.common.Parameters\n\nimport scala.concurrent._\nimport cats.effect._\nimport cats.implicits._\n\ndef cancelableCheck(source: String, flags: String)(implicit ec: ExecutionContext): IO[Diagnostics] =\n  IO.cancelable { cb =>\n    val source = new CancellationTokenSource\n    ec.run(() => {\n      cb(Right(ReDoS.check(source, flags, Parameters(), Some(source.token)))\n    })\n    IO(source.cancel()).void\n  }\n")))}h.isMDXComponent=!0}}]);