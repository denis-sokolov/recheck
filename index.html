<!doctype html><html lang=en-us><head><meta name=generator content="Hugo 0.80.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>recheck | MakeNowJust-Labo</title><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css><script defer src=https://use.fontawesome.com/releases/v5.15.2/js/all.js></script><script defer src=https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.0/dist/alpine.min.js></script><style>[x-cloak]{display:none}</style></head><body><header class="hero is-medium is-dark is-bold"><div class=hero-body><div class=container><div class="columns has-vcentered"><div class="column is-half"><h1 class=title>recheck</h1><h2 class=subtitle>A vulnerable RegExp (ReDoS) checker.</p><div class="mt-4 buttons"><a class="button is-link" href=https://github.com/MakeNowJust-Labo/recheck><span class="icon is-small"><i class="fab fa-github"></i></span><span>GitHub</span></a></div></div><div class="column is-half" x-data=checker()><div class=box><div class="field is-horizontal"><div class="field-label is-normal"><label class=label for=input>RegExp</label></div><div class=field-body><div class=field><p class=control><textarea id=input class="textarea is-family-monospace" placeholder=/^(a|a)*$/ rows=2 :disabled="state === 'checking'" x-model=input></textarea></p></div></div></div><div class="field has-text-right"><div class=control><label class=radio><input type=radio name=checker value=hybrid x-model=checker>
hybrid</label>
<label class=radio><input type=radio name=checker value=automaton x-model=checker>
automaton</label>
<label class=radio><input type=radio name=checker value=fuzz x-model=checker>
fuzz</label></div></div><div class="field has-text-right"><button class="button is-light" @click=cancel() x-show="state === 'checking'" x-cloak>Cancel</button>
<button class=button :class="{ 'is-loading': state === 'checking' }" @click=check()>Check</button></div><template x-if="state === 'checked'"><div class="box is-shadowless"><div class=columns><div class="column is-one-quarters"><span class=has-text-weight-bold>Input</span></div><div class="column is-three-quarters"><div class=content><pre class=p-2 x-text=checkedInput></pre></div></div></div><div class=columns><div class="column is-one-quarters"><span class=has-text-weight-bold>Time</span></div><div class="column is-three-quarters" x-text="`${checkedTime / 1000} s`"></div></div><div class=columns><div class="column is-one-quarters"><span class=has-text-weight-bold>Status</span></div><div class="column is-three-quarters"><span class=tag :class="{
                          'is-danger': checkedResult.status === 'vulnerable',
                          'is-success': checkedResult.status === 'safe',
                          'is-warning': checkedResult.status === 'unknown',
                        }" x-text=checkedResult.status></span></div></div><template x-if="checkedResult.status !== 'unknown'"><div class=columns><div class="column is-one-quarters"><span class=has-text-weight-bold>Complexity</span></div><div class="column is-three-quarters"><span class=tag :class="{
                          'is-danger': checkedResult.complexity.type === 'exponential',
                          'is-warning': checkedResult.complexity.type === 'polynomial',
                          'is-success': checkedResult.status === 'safe',
                        }" x-text=checkedResult.complexity.summary></span></div></div></template><template x-if="checkedResult.status === 'vulnerable'"><div class=columns><div class="column is-one-quarters"><span class=has-text-weight-bold>Attack string</span></div><div class="column is-three-quarters"><div class=content><pre class=p-2 x-text=checkedResult.attack.pattern></pre></div></div></div></template><template x-if="checkedResult.status === 'vulnerable'"><div class=columns><div class="column is-one-quarters"><span class=has-text-weight-bold>Hotspot</span></div><div class="column is-three-quarters"><div class=content><pre class=p-2>/<span><template x-for="(spot, index) in checkedHotspot" :key=index><span :class="{
                            'has-text-white': spot.temperature,
                            'has-background-danger-dark': spot.temperature === 'heat',
                            'has-background-success-dark': spot.temperature === 'normal',
                          }" x-text=spot.text></span></template></span>/<span x-text=checkedResult.flags></span></pre></div></div></div></template><template x-if="checkedResult.status === 'unknown'"><div class=columns><div class="column is-one-quarters"><span class=has-text-weight-bold>Error</span></div><div class="column is-three-quarters"><span class=tag :class="{
                          'is-danger': checkedResult.error.kind !== 'timeout',
                          'is-warning': checkedResult.error.kind === 'timeout',
                        }" x-text=checkedResult.error.kind></span><span x-text="`(${checkedResult.error.message})`" x-show="checkedResult.error.kind !== 'timeout'"></span></div></div></template><template x-if=checkedResult.checker><div class=columns><div class="column is-one-quarters"><span class=has-text-weight-bold>Checker</span></div><div class="column is-three-quarters"><span class="tag is-primary" x-text=checkedResult.checker></span></div></div></template></div></template></div></div></div></div></div></header><script src=https://makenowjust-labo.github.io/recheck/main.min.1d8b671862a295dce855c09edb194d4a0cecc59944ea51ae71ae4afb7a02deea.js></script><section class=section><div class=container><div class="item columns"><div class="column is-6 px-6"><div class=content><p class=has-text-centered><img height=80px src=img/hybrid.svg></p><h3 class=has-text-centered>Hybrid</h3><p class="has-text-justified is-size-5">Choose either automaton theory based algorithm or fuzzing depending on the RegExp.
It is fast, strict and state-of-the-art algorithm to detect ReDoS vulnerability.</p></div></div><div class="column is-6 px-6"><div class=content><p class=has-text-centered><img height=80px src=img/language.svg></p><h3 class=has-text-centered>JavaScript & Scala</h3><p class="has-text-justified is-size-5">Support JavaScript (ECMA-262) RegExp.
This is written in Scala, and compiled into JavaScript powered by Scala.js.
We can use this from both Scala and JavaScript.</p></div></div></div></div></section><main class=section><div class=container><div class=content><h2 id=getting-started>Getting Started</h2><h3 id=javascript>JavaScript</h3><p>Uses the following command to install this library:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ npm install @makenowjust-labo/recheck
</code></pre></div><p>This library exports only an API called <code>check</code>.
It takes a RegExp pattern source and flags, and returns the analysis result.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>check</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;@makenowjust-labo/recheck&#34;</span>);

<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>check</span>(<span style=color:#e6db74>&#34;^(a|a)*$&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>));
<span style=color:#75715e>// {
</span><span style=color:#75715e>//   status: &#39;vulnerable&#39;,
</span><span style=color:#75715e>//   checker: &#39;automaton&#39;,
</span><span style=color:#75715e>//   attack: {
</span><span style=color:#75715e>//     pumps: [ { prefix: &#39;a&#39;, pump: &#39;a&#39;, bias: 0 } ],
</span><span style=color:#75715e>//     suffix: &#39;\x00&#39;,
</span><span style=color:#75715e>//     base: 17,
</span><span style=color:#75715e>//     string: &#39;aaaaaaaaaaaaaaaaaa\x00&#39;,
</span><span style=color:#75715e>//     pattern: &#34;&#39;a&#39; &#39;a&#39;ยนโท &#39;\\x00&#39;&#34;
</span><span style=color:#75715e>//   },
</span><span style=color:#75715e>//   complexity: { type: &#39;exponential&#39;, summary: &#39;exponential&#39;, isFuzz: false }
</span><span style=color:#75715e>// }
</span></code></pre></div><p>See <a href=https://github.com/MakeNowJust-Labo/recheck/blob/master/packages/recheck/README.md>the detailed information</a>.</p><h3 id=scala>Scala</h3><p>Adds the following line into your <code>build.sbt</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala>libraryDependencies <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#34;codes.quine.labo&#34;</span> <span style=color:#f92672>%%</span> <span style=color:#e6db74>&#34;recheck&#34;</span> <span style=color:#f92672>%</span> <span style=color:#e6db74>&#34;3.1.0&#34;</span>
</code></pre></div><p><code>ReDoS</code> object is a frontend of this library.
You can use <code>ReDoS.check</code> method to analyze RegExp pattern.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=color:#66d9ef>import</span> codes.quine.labo.recheck.ReDoS

println<span style=color:#f92672>(</span><span style=color:#a6e22e>ReDoS</span><span style=color:#f92672>.</span>check<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;^(a|a)*$&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>))</span>
<span style=color:#75715e>// Input        : /^(a|a)*$/
</span><span style=color:#75715e>// Status       : vulnerable
</span><span style=color:#75715e>// Complexity   : exponential
</span><span style=color:#75715e>// Attack string: &#39;a&#39; &#39;a&#39;ยนโท &#39;\x00&#39;
</span><span style=color:#75715e>// Hotspot      : /^([41ma[0m|[41ma[0m)*$/
</span><span style=color:#75715e>// Checker      : automaton
</span></code></pre></div><h2 id=license>License</h2><p>MIT License.</p></div></div></main><footer class=footer><div class="content has-text-centered"><p>2020-2021 (C) TSUYUSATO "MakeNowJust" Kitsune</p></div></footer></body></html>